{% load static %}


<script type="text/x-template" id="{{ id }}">
{% verbatim %}
    <div v-cloak v-if="registration && conference" class="bg-lighter p-4">
        <h4 class="text-secondary mb-4">Payment: <samp>{{ registration.uuid }}</samp></h4>
        <div v-if="registration.is_paid" class="mb-3">
            <a target="_blank" href="#" class="mr-4">
                <span><i class="material-icons mr-2">&#xE02F;</i>Download invoice</span>
            </a>
            <a target="_blank" href="#">
                <span><i class="material-icons mr-2">&#xE02F;</i>Certificate of attendance</span>
            </a>
        </div>
        <div v-if="registration.is_paid">
            <div class="row">
                <div class="col-12 col-md-8">
                    <p>Your registration for {{ conference.name }}, {{ conference.full_name }}, <strong>has been fully paid</strong>. You can find your payment activity below, with a link to download your invoice.</p>
                    <p>Feel free to <a href="mailto:support@toucon.net" target="_blank">contact us</a> if you have any question.</p>
                </div>
                <div class="col-12 col-md-4 text-right">
                    <h5 class="text-success font-weight-normal"><i class="material-icons mr-2">&#xE5CA;</i>Paid</h5>
                </div>
            </div>
        </div>
        <div v-else>
            <div class="row">
                <div class="col-12 col-md-8">
                    <p>You still have to pay <strong>{{ registration.pending_amount }}</strong> from your registration for {{ conference.name }}, {{ conference.full_name }}.</p>
                </div>
                <div class="col-12 col-md-4 text-right">
                    <h5 class="text-success font-weight-normal text-warning text-underline">Pending {{ registration.pending_amount }}</h5>
                </div>
            </div>
            <hr class="my-4">
            <div class="row">
                <div class="col-12 col-md-1">
                    <h1 class="text-secondary">1.</h1>
                </div>
                <div class="col-12 col-md-3">
                    <p>If you received a coupon, please apply the coupon code to update your balance before proceeding to pay.</p>
                </div>
                <div class="col-12 col-md-8">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Coupon code...">
                        <span class="input-group-btn">
                            <button class="btn btn-secondary" type="button">Update balance</button>
                        </span>
                    </div>
                </div>
            </div>
            <hr class="my-4">
            <div class="row">
                <div class="col-12 col-md-1">
                    <h1 class="text-secondary">2.</h1>
                </div>
                <div class="col-12 col-md-3">
                    <p>Pay {{ registration.pending_amount }}</p>
                    <label><input type="radio" name="method" v-model="method" value="invoice" class="mr-1"> via bank transfer</label>
                    <label><input type="radio" name="method" v-model="method" value="card" class="mr-1"> by credit card, using our secure payment platform</label>
                    <div v-show="method == 'card'" class="my-3">
                        {% endverbatim %}
                        <a href="https://stripe.com/about" target="_blank">
                            <img src="{% static 'images/stripe.svg' %}">
                        </a>
                        {% verbatim %}
                    </div>
                </div>
                <div v-show="method == 'card'" class="col-12 col-md-8">
                    <div class="form-group">
                        <label>Cardholder name <small class="text-danger">*</small></label><br>
                        <input v-model.trim="cardholder" type="text" class="form-control">
                    </div>
                    <div class="form-group">
                        <label>Credit or debit card <small class="text-danger">*</small></label><br>
                        <div ref="cardElement"></div>
                        <small v-if="error" class="form-text text-danger">{{ error }}</small>
                        <small v-else class="form-text text-muted">We will never store your card information.</small>
                    </div>
                    <button @click="pay" class="btn btn-primary mt-3 btn-block" :disabled="cardholder == '' || processing" :class="{'btn-secondary': processing}">
                        <span v-if="!processing">Pay {{ registration.pending_amount }}</span>
                        <span v-else>Processing...</span>
                    </button>
                </div>
                <div v-show="method == 'invoice'" class="col-12 col-md-8">
                    <p>Contact us if you prefer to receive an invoice and pay by bank transfer.</p>
                    <button class="btn btn-secondary">I want an invoice</button>
                </div>
            </div>
        </div>
    </div>
{% endverbatim %}
</script>
